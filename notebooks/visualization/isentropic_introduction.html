
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Overview of Isentropic Analysis &#8212; Unidata AMS 2021 Python Workshop</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap');
</style>
    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme-unidata.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Matplotlib: Basics" href="matplotlib-basics.html" />
    <link rel="prev" title="MetPy Skew-T" href="MetPy%20SkewT.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
  <nav class="navbar navbar-dark navbar-expand-lg bg-unidata fixed-top bd-navbar shadow" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/Unidata_logo_horizontal.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../agenda.html">Agenda</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../setup.html">Workshop Environment</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../projects.html">Project Ideas</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../../resources.html">Resources</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../showcase.html">Workshop Showcase</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/Unidata/pyaos-ams-2021" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/Unidata" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
  </nav>


    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="../dataAccess.html">Data Access Notebooks</a>
                </li>
            
          
            
                <li class="">
                    <a href="../analysis.html">Analysis Notebooks</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="../visualization.html">Visualization Notebooks</a>
                    <ul>
                    
                        <li class="">
                            <a href="Declarative-Example.html">Declarative Syntax Example</a>
                        </li>
                    
                        <li class="">
                            <a href="MetPy%20SkewT.html">MetPy Skew-T</a>
                        </li>
                    
                        <li class="active">
                            <a href="">Overview of Isentropic Analysis</a>
                        </li>
                    
                        <li class="">
                            <a href="matplotlib-basics.html">Matplotlib: Basics</a>
                        </li>
                    
                        <li class="">
                            <a href="matplotlib-intermediate.html">Matplotlib: Intermediate</a>
                        </li>
                    
                        <li class="">
                            <a href="python-awips-WorkingWithMapsTopoDatabases.html">python-awips: Working with the Maps and Topo Databases</a>
                        </li>
                    
                        <li class="">
                            <a href="python-awips-WorkingWithModels.html">python-awips: Working with Models</a>
                        </li>
                    
                        <li class="">
                            <a href="python-awips-WorkingWithSatelliteData.html">python-awips: Working with Satellite Data</a>
                        </li>
                    
                        <li class="">
                            <a href="python-awips-WorkingWithSurfaceObs.html">python-awips: Working with Surface Obs</a>
                        </li>
                    
                        <li class="">
                            <a href="python-awips-WorkingWithUpperAirObs.html">python-awips: Working with Upper Air Obs</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="../notebook_enhancements.html">Enhancing Your Notebooks</a>
                </li>
            
          
            
                <li class="">
                    <a href="../index.html">Notebook Index</a>
                </li>
            
          
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#unidata-ams-2021-student-conference" class="nav-link">Unidata AMS 2021 Student Conference</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#focuses" class="nav-link">Focuses</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#objectives" class="nav-link">Objectives</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#imports" class="nav-link">Imports</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#understanding-isentropic-coordinates" class="nav-link">1. Understanding Isentropic Coordinates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#interpolation-to-isentropic-coordinates" class="nav-link">2. Interpolation to Isentropic Coordinates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#plotting-isentropic-coordinates" class="nav-link">3. Plotting Isentropic Coordinates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#see-also" class="nav-link">4. See also</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <p><a name="top"></a></p>
<div style="width:1000 px">
<div style="float:right; width:98 px; height:98px;">
<img src="https://raw.githubusercontent.com/Unidata/MetPy/master/src/metpy/plots/_static/unidata_150x150.png" alt="Unidata Logo" style="height: 98px;">
</div>
<div class="section" id="overview-of-isentropic-analysis">
<h1>Overview of Isentropic Analysis<a class="headerlink" href="#overview-of-isentropic-analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="unidata-ams-2021-student-conference">
<h2>Unidata AMS 2021 Student Conference<a class="headerlink" href="#unidata-ams-2021-student-conference" title="Permalink to this headline">¶</a></h2>
<div style="clear:both"></div>
</div>
<hr class="docutils" />
<p>Analysis and visualization in isentropic coordinates can be an important tool for synoptic meteorology. This notebook provides an introduction to isentropic coordinates and demonstrates basic plotting for isentropic analysis.</p>
<div style="float:right; width:250 px"><img src="../../instructors/images/isentropic_preview.png" alt="Example plot in isentropic coordinates" style="height: 400px;"></div>
</div>
<div class="section" id="focuses">
<h2>Focuses<a class="headerlink" href="#focuses" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Understand the difference between isentropic and isobaric coordinates</p></li>
<li><p>Demonstrate isentropic coordinate for synoptic meteorology</p></li>
<li><p>Convert model output in isobaric coordinates to isentropic coordinates with <a class="reference external" href="https://unidata.github.io/MetPy/latest/index.html">MetPy</a></p></li>
<li><p>Demonstrate visualizing this with <a class="reference external" href="https://matplotlib.org/">Matplotlib</a></p></li>
</ul>
</div>
<div class="section" id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#1.-Understanding-Isentropic-Coordinates">Understanding Isentropic Coordinates</a></p></li>
<li><p><a class="reference external" href="#2.-Interpolation-to-Isentropic-Coordinates">Interpolation to Isentropic Coordinates</a></p></li>
<li><p><a class="reference external" href="#3.-Plotting-Isentropic-Coordinates">Plotting Isentropic Coordinates</a></p></li>
<li><p><a class="reference external" href="#4.-See-also">See also</a></p></li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h2>
<p>We will begin by importing the important packages to be used throughout this example. This example will use sample data included within the MetPy package. Further examples of isentropic interpolation and analysis can be found in the <a class="reference external" href="https://unidata.github.io/MetPy/latest/examples/isentropic_example.html#sphx-glr-examples-isentropic-example-py">MetPy documentation</a> and in the <a class="reference external" href="https://unidata.github.io/python-gallery/examples/Isentropic_Interpolation.html#sphx-glr-examples-isentropic-interpolation-py">Unidata Python Gallery</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">metpy.calc</span> <span class="k">as</span> <span class="nn">mpcalc</span>
<span class="kn">from</span> <span class="nn">metpy.cbook</span> <span class="kn">import</span> <span class="n">get_test_data</span>
<span class="kn">from</span> <span class="nn">metpy.plots</span> <span class="kn">import</span> <span class="n">add_timestamp</span>
<span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="understanding-isentropic-coordinates">
<h2>1. Understanding Isentropic Coordinates<a class="headerlink" href="#understanding-isentropic-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Gridded meteorological data, such as model output, is provided on a grid, regularly spaced horizontally, vertically, and in time. Horizontally, such data is typically projected to a geographic reference grid, such as the Lambert Conformal Conic, with common units of distance (typically meters). The vertical coordinate can also be geo-referenced in meters (either above mean sea level, MSL, or above ground level, AGL). However, it is more common to use units of pressure as the vertical coordinate. This is called <em>isobaric coordinates</em>, where height is referenced by decreasing pressure as altitude increases. This system is quite common in synoptic meteorology, and is often the system in which gridded data is provided.</p>
<p>Another choice of vertical reference is to use potential temperature rather than pressure. This is referred to as <em>isentropic coordinates</em>. Potential temperature increases with increasing height for a neutral or statically stable atmosphere. This means that a constant surface of potential temperature (called an <em>isentropic surface</em>) can be used as the vertical reference.</p>
<p>Just like isobaric surfaces are used for synoptic analysis (such as the 500-mb height analysis), an isentropic surface can also be used. A parcel of air will remain at the same potential temperature at it moves through the atmosphere since this movement is adiabatic. Therefore, air parcels will travel horizontally along isentropic surfaces. The advantage of isentropic analysis then is that if wind vectors are plotting, movement along the surface can be implied directly, rather than through geostrophic asumptions inherent in isobaric coordinates. Additionally, if pressure is contoured on the surface, vertical motion can be implied directly without the need for Quasi-Geostrophic assumptions.</p>
<p>For a more complete description of isentropic coordinates and its associated advantages and disadvantages, see this <a class="reference external" href="https://www.atmos.illinois.edu/~snesbitt/ATMS505/stuff/07_Isentropic%20Analysis.pdf">presentation</a> from the University of Illinois.</p>
<p><a href="#top">Top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="interpolation-to-isentropic-coordinates">
<h2>2. Interpolation to Isentropic Coordinates<a class="headerlink" href="#interpolation-to-isentropic-coordinates" title="Permalink to this headline">¶</a></h2>
<p>To perform an anlysis on isentropic surfaces, we must first convert our data to isentropic coordinates. This is easily acomplished with <code class="docutils literal notranslate"><span class="pre">mpcalc.isentropic_interpolation</span></code>. Let’s start by opening some sample data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">get_test_data</span><span class="p">(</span><span class="s1">&#39;narr_example.nc&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">set_coords</span><span class="p">([</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>All that is required to interpolate to isentropic coordinates is to specify the surfaces we want.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isentlevs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">296.</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">kelvin</span>
<span class="n">isent_data</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">isentropic_interpolation_as_dataset</span><span class="p">(</span>
    <span class="n">isentlevs</span><span class="p">,</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">],</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;u_wind&#39;</span><span class="p">],</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;v_wind&#39;</span><span class="p">],</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Specific_humidity&#39;</span><span class="p">],</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Geopotential_height&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/drewcamron/miniconda3/envs/pyaos-ams-2021/lib/python3.9/site-packages/metpy/interpolate/one_dimension.py:147: UserWarning: Interpolation point out of data bounds encountered
  warnings.warn(&#39;Interpolation point out of data bounds encountered&#39;)
</pre></div>
</div>
</div>
</div>
<p>To make plotting easier, we will perform some unit conversions and calculate relative humidity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert wind to kt</span>
<span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;u_wind&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;u_wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="s1">&#39;kt&#39;</span><span class="p">)</span>
<span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;v_wind&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;v_wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="s1">&#39;kt&#39;</span><span class="p">)</span>

<span class="c1"># Calculate relative humidity</span>
<span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;Relative_humidity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">relative_humidity_from_specific_humidity</span><span class="p">(</span>
    <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">],</span>
    <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span>
    <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;Specific_humidity&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="s1">&#39;percent&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>That’s it! Our original gridded model data in isobaric coordinates has been converted to isentropic coordinates. Now, on to plotting.</p>
<p><a href="#top">Top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="plotting-isentropic-coordinates">
<h2>3. Plotting Isentropic Coordinates<a class="headerlink" href="#plotting-isentropic-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Plotting isentropic coordinates is much the same as for isobaric coordinates. A common analysis is to plot pressure, wind, and relative humidity on a constant isentropic surface. This can be accomplished through the use of <code class="docutils literal notranslate"><span class="pre">ax.contour</span></code>, <code class="docutils literal notranslate"><span class="pre">ax.contourf</span></code>, and <code class="docutils literal notranslate"><span class="pre">ax.barbs</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up our projection and coordinates</span>
<span class="n">crs</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mf">45.0</span><span class="p">)</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">longitude</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">latitude</span>

<span class="c1"># Coordinates to limit map area</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mf">122.</span><span class="p">,</span> <span class="o">-</span><span class="mf">75.</span><span class="p">,</span> <span class="mf">25.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">)]</span>
<span class="c1"># Choose a level to plot, in this case 296 K (our sole level in this example)</span>
<span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">17.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="o">*</span><span class="n">bounds</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="o">.</span><span class="n">with_scale</span><span class="p">(</span><span class="s1">&#39;50m&#39;</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">STATES</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Plot the surface</span>
<span class="n">clevisent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">isentropic_level</span><span class="o">=</span><span class="n">level</span><span class="p">),</span>
                <span class="n">clevisent</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">cs</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inline_spacing</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">rightside_up</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">use_clabeltext</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot RH</span>
<span class="n">cf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;Relative_humidity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">isentropic_level</span><span class="o">=</span><span class="n">level</span><span class="p">),</span>
                 <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gist_earth_r</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                  <span class="n">extendrect</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Relative Humidity&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>

<span class="c1"># Plot wind barbs</span>
<span class="n">ax</span><span class="o">.</span><span class="n">barbs</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;u_wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">isentropic_level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
         <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;v_wind&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">isentropic_level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
         <span class="n">regrid_shape</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Make some titles</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">isentlevs</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="si">:</span><span class="s1">~.0f</span><span class="si">}</span><span class="s1"> Isentropic Pressure (hPa), Wind (kt), &#39;</span>
             <span class="s1">&#39;Relative Humidity (percent)&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">add_timestamp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">isent_data</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[ms]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">),</span>
              <span class="n">y</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">high_contrast</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/isentropic_introduction_17_0.png" src="../../_images/isentropic_introduction_17_0.png" />
</div>
</div>
<p>In the above image, it can be inferred that there is rising motion over much of New England where the wind vectors show motion from higher pressure toward lower pressure across pressure contours.</p>
<p><a href="#top">Top</a></p>
</div>
<hr class="docutils" />
<div class="section" id="see-also">
<h2>4. See also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<p>For a more complete description of isentropic coordinates and its associated advantages and disadvantages, see this <a class="reference external" href="https://www.atmos.illinois.edu/~snesbitt/ATMS505/stuff/07_Isentropic%20Analysis.pdf">presentation</a> from the University of Illinois. Further examples of isentropic interpolation and analysis can be found in the <a class="reference external" href="https://unidata.github.io/MetPy/latest/examples/isentropic_example.html#sphx-glr-examples-isentropic-example-py">MetPy documentation</a> and in the <a class="reference external" href="https://unidata.github.io/python-gallery/examples/Isentropic_Interpolation.html#sphx-glr-examples-isentropic-interpolation-py">Unidata Python Gallery</a></p>
<p><a href="#top">Top</a></p>
<hr class="docutils" />
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="MetPy%20SkewT.html" title="previous page">MetPy Skew-T</a>
    <a class='right-next' id="next-link" href="matplotlib-basics.html" title="next page">Matplotlib: Basics</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-92978945-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020, Unidata. Development supported by National Science Foundation grant AGS-1901712.<br/>
        Last updated on Jan 09, 2021 at 17:40:43.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>